---
title: "Stats Modeling Project"
author: "Group 5: Xin Jin, Reid Ginoza, Heidi Lovejoy"
date: "11/18/2019"
output: pdf_document
bibliography: bibliography.bib
nocite: | 
  @rlang
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(kableExtra) # for tables
library(magrittr)  # provides more pipe oeprators
library(haven)
options(knitr.table.format = "latex")
```

```{r import data}
institution_data <- read_spss('InstLevel.sav') %>%
  select(  # TODO will change later when we decide what variables we want
  -unitid, -addr1_txt, -addr2_txt, -city_txt, -zip_text, -sector_cd,
  -ClassificationCode, -ClassificationOther
  ) %>%
  filter(grepl('4-year', sector_name))  %>% # only 4-year Schools
  filter(is.na(IL_PARTIC_COED_MEN) | IL_PARTIC_COED_MEN == 0 ) %>% # only schools with no male participants in coed
  filter(is.na(IL_PARTIC_COED_WOMEN) | IL_PARTIC_COED_WOMEN == 0 ) %>% # only schools with no female participants in coed
  select(-contains("COED")) # ignore variables with the word "coed"

```

```{r Notes to self, include=FALSE}
# To view the school data
# school_data <- read_spss('Schools.sav') %>% select(
#   -unitid, -addr1_txt, -addr2_txt, -zip_text, -ClassificationCode,-ClassificationOther,
#   -sector_cd
#   )

# To view variables included as a list (although you could probably just view the data):
# institution_columns <- institution_data %>% colnames()

# To view number of NAs in a column:
# count.of.na <- institution_data %>% summarise_all(~sum(is.na(.)))
```

# Introduction
%TODO Briefly give meaning to your project â€“ what is the background and why is this project important?  (20 points)

# Hypotheses
%TODO Clearly state the hypotheses being tested. (20 points)

# Methods
%TODO State and explain the methodology used to test the hypotheses.  (20 points)

# Results
%TODO Describe the data (1st paragraph)

## Visualizing Head Coach data
```{r hist of head coach, message=FALSE}
ncaa.div.i_hd.coach <- institution_data %>%
  filter(grepl('NCAA Division I-', classification_name)) %>%
  select(sector_name, HDCOACH_SALARY_MEN)

ncaa.div.i_hd.coach %>%
  ggplot(aes(x = HDCOACH_SALARY_MEN, fill = sector_name)) +
  geom_histogram(position = "dodge") +
  labs(title="Histogram of NCAA Div. I Men's Head Coach Salary", x = "Salary (USD)",
       y = "Count", fill = "School Type:") +
  theme(
    legend.position="bottom",
    panel.background = element_rect(fill = 'white', color = 'grey'),
    panel.grid.major = element_line(size = 0.25, linetype = 'solid',
                                color = "grey"), 
    panel.grid.minor = element_line(size = 0.1, linetype = 'solid',
                                color = "grey")
  )
```

## Visualizing Number of Athletes and Head Coach Salaries
```{r scatter plot of head coach salaries}
participation.data <- institution_data %>%
  select(IL_PARTIC_MEN, HDCOACH_SALARY_MEN)

participation.data %>% ggplot(aes(x=IL_PARTIC_MEN, y=HDCOACH_SALARY_MEN)) +
  geom_point() +
  labs(title="Scatterplot of Men's Head Coach Salary by Men Particiation Counts", x = "Count of Men Participating",
       y = "Head Coach's Salary (USD)") +
  theme(
    panel.background = element_rect(fill = 'white', color = 'grey'),
    panel.grid.major = element_line(size = 0.25, linetype = 'solid',
                                color = "grey"), 
    panel.grid.minor = element_line(size = 0.1, linetype = 'solid',
                                color = "grey")
  )
```

%TODO And analysis results (order of results should correspond to hypotheses listed).  (20 points)

# Conclusion
%TODO Restate the results in terms of the larger picture; state limitations and opportunities forfuture research (20 points)

## Session Info
```{r Session Info}
sessionInfo()
```

# References